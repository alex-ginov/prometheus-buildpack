global:
  scrape_interval:     <%= ENV["PROMETHEUS_GLOBAL_SCRAPE_INTERVAL"] || "1m" %>
  evaluation_interval: <%= ENV["PROMETHEUS_GLOBAL_EVALUATION_INTERVAL"] || "1m" %>

remote_write:
  - url: "<%= ENV["INFLUXDB_URL"] || ENV["INFLUX_URL"] %>"
    basic_auth:
      username: "<%= ENV["INFLUX_USER"] %>"
      password: "<%= ENV["INFLUX_PASSWORD"] %>"
    remote_timeout: 30s

scrape_configs:
# Get Prometheus self-metrics
- job_name: "prometheus"
  basic_auth:
    username: "<%= ENV["BASIC_AUTH_USERNAME"] %>"
    password: "<%= ENV["BASIC_AUTH_PASSWORD"] %>"
  static_configs:
    - targets: ["<%= ENV["CANONICAL_HOST"] %>"]

# Get user-defined metrics
<%= scrape_configs.to_yaml.gsub("---\n", "") %>
